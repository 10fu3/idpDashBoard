(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{407:function(e,t,n){"use strict";n.r(t);n(37),n(17),n(22),n(43);var r={methods:{drop:function(e){var t=e.target.files||e.dataTransfer.files;this.setIcon(t[0])},setIcon:function(e){var t=null!=e?e:this.lists[0].file,n=this.validate("icon",t.name);n.length>0?alert(n):(this.lists[0].file=t,this.lists[0].fileName=t.name)},validate:function(e,t){var n="";switch(e){case"icon":if(null==t||null==t)n="画像がアップロードされていません";else{var r=t.split(".");switch(r[r.length-1]){case"png":case"jpg":case"jpeg":case"bmp":break;default:n=".png .jpg .jpeg .bmpの拡張子のファイルに対応しています"}}break;case"redirect-url":this.urlReg.test(t)||(n="有効なURLを入力してください");break;case"service-name":case"description":t.length<1&&(n="1文字以上入力してください");break;case"permissions":for(var l=!1,i=0;i<t.length;i++)1==t[i].value&&(l=!0);l||(n="一つも権限が設定されていません")}return n},removeFile:function(){this.lists[0].fileName="",this.lists[0].file=null},reg_request:function(param){for(var e="",i=0;i<param.length;i++){if("icon_url"===param[i].id){var t=this.lists[0].file.name.split("."),n=t[t.length-1];"png"!==n&&"jpg"!=n&&"jpeg"!==n&&"bmp"!==n&&(e="png jpg jpeg bmp の拡張子に対応しています")}else e="permissions"===param[i].id?this.validate(param[i].id,param[i].value):this.validate(param[i].id,param[i].input);e.length>0&&alert(e)}if(!(e.length>0)){var r,l,o,data={};for(i=0;i<param.length;i++)if("permissions"===param[i].id){data.permissions=[];for(var c=0;c<param[i].value.length;c++){var element=param[i].value[c];!0===element.value&&data.permissions.push(element.id)}}else data[param[i].id]=param[i].input;r=this.lists[0].file,l=function(e){var t;data.icon_url=e,t=data,fetch("http://localhost/api/v1/service/",{method:"post",headers:new Headers({Authorization:localStorage.getItem("authorization")}),body:JSON.stringify(t)}).then((function(e){return e.ok?{}:e.json()})).then((function(e){e.error?alert(e.error):(alert("サービスの追加に成功しました"),location.href="/service_management")}))},(o=new FormData).append("file",r),fetch("http://localhost/api/v1/img",{method:"POST",body:o}).then((function(e){return e.json()})).then((function(e){l(e.url)}))}}},data:function(){var e=this;return{urlReg:/https?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .?%&=]*)?/,reg:/^(([^<>()[\]\\.,;:\s@]+(\.[^<>()[\]\\.,;:\s@]+)*)|(.+))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,lists:[{rule:function(e){},fileName:"",input:null,id:"icon_url",category:"アイコン",value:""},{rule:function(e){return e&&e.length>=1||"1文字は設定してください"},input:"",id:"service_name",category:"サービス名",value:"",type:"text"},{rule:function(t){return e.urlReg.test(t)||"有効なURLを入力してください"},input:"",id:"redirect_url",category:"リダイレクト先のURL コールバックURL",value:"",type:"text"},{rule:function(e){return!0},input:"",id:"permissions",category:"使用する権限",type:"",value:[{tag:"OpenID",id:"read_uuid",value:!1},{tag:"プロフィール",id:"read_profile",value:!1},{tag:"メールアドレス",id:"read_mail",value:!1}]},{rule:function(e){return e&&e.length>=1||"1文字は設定してください"},input:"",id:"description",category:"サービスの説明",value:"",type:"text"}]}}},l=n(74),o=n(108),c=n.n(o),v=n(231),d=n(345),f=n(344),h=n(396),m=n(339),_=n(395),w=n(401),y=n(392),j=n(394),k=n(353),component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",[n("v-col",[n("v-row",[n("v-col",[n("v-card",{staticClass:"mx-auto mt-5",attrs:{width:"500px",elevation:"9"}},[n("v-card-title",{staticClass:"justify-center"},[n("v-container",[n("h2",{staticClass:"font-weight-light",attrs:{align:"center"}},[e._v("\n                      新規サービス登録\n                    ")])])],1),e._v(" "),n("v-card-text",[n("v-container",[e._l(e.lists,(function(t,r){return[n("v-card",{key:r,staticClass:"mb-5"},[n("v-card-text",["icon_url"!==t.id&&"permissions"!==t.id?n("div",[n("v-container",[n("p",[e._v(e._s(t.category)+"を設定")]),e._v(" "),n("v-text-field",{attrs:{type:t.type,rules:[t.rule]},model:{value:t.input,callback:function(n){e.$set(t,"input",n)},expression:"list.input"}})],1)],1):"permissions"===t.id?n("div",[n("v-container",[n("p",[e._v(e._s(t.category)+"を設定")]),e._v(" "),e._l(t.value,(function(t,r){return n("div",{key:r},[n("p",[e._v(e._s(t.tag))]),e._v(" "),n("v-switch",{model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"perm.value"}})],1)}))],2)],1):n("div",{on:{dragover:function(e){e.preventDefault()},drop:function(t){return t.preventDefault(),e.drop(t)}}},[n("v-container",[n("p",[e._v(e._s(t.category)+"を設定")]),e._v(" "),n("p",[e._v("imgurというアップローダーに画像がアップロードされます")]),e._v(" "),n("br"),e._v(" "),n("v-file-input",{attrs:{accept:"image/png, image/jpeg, image/bmp",placeholder:"png jpeg bmp","prepend-icon":"mdi-camera"},on:{change:e.setIcon}}),e._v(" "),n("p",[e._v(e._s(e.lists[0].fileName))]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"error",outlined:""},on:{click:function(t){return t.stopPropagation(),e.removeFile(t)}}},[e._v("削除")])],1)],1)])],1)]}))],2)],1),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{"x-large":"",color:"success",block:""},on:{click:function(t){return e.reg_request(e.lists)}}},[e._v("\n                      作成\n                      ")])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;c()(component,{VBtn:v.a,VCard:d.a,VCardActions:f.a,VCardText:f.b,VCardTitle:f.c,VCol:h.a,VContainer:m.a,VFileInput:_.a,VRow:w.a,VSpacer:y.a,VSwitch:j.a,VTextField:k.a})}}]);